<%= form_for @activity do |f|%>






    
    
    <%# ticket_types nested form %>

    <%# add form %>
    <div class="nested-container">
      <div class="nested-foorm-header">
        <div>票券名稱</div>
        <div>數量</div>
        <div>價格</div>
        <div>操作</div>
      </div>

      <div data-controller="ticket-types-form" class="nested-form">
        <template data-ticket-types-form-target="form">
          <%= f.fields_for :ticket_types, TicketType.new, child_index: 'NEW_FORM' do |new_form|%>  
            <div class="ticketType-form" new-ticket_types ="<%= new_form.object.new_record? %>" >
              <div class="nested-basic-info">
                <%= new_form.text_field:title%>
                <%= new_form.number_field:quantity, placeholder: '數量', min: 0 %>
                <%= new_form.number_field:price, placeholder: '票價', min:0 %>

                <%= link_to '#' do %>
                  <i class="fas fa-chevron-circle-down"></i>
                <% end %>            

                <%= link_to '#', data: { action: 'ticket-types-form#removeTicketType' } do %>
                  <i class="far fa-trash-alt new-ticket-delete-btn"></i>
                <% end %>
              </div>


            <div class="collapse.show nested-hidden-info" id="e" >
              <div class="card card-body">
                <div>
                  <%= new_form.label:sell_start, '售票開始日'%>
                </div>

                <div>
                  <%= new_form.date_field:sell_start %>
                  <%= new_form.time_field:sell_start %>
                </div>

                <div>
                  <%= new_form.label:finish_datetime, '結束時間' %>
                </div>

                <div>
                  <%= new_form.date_field:sell_deadline %>
                  <%= new_form.time_field:sell_deadline %>
                </div>

                <%= new_form.label:content, '票券說明'%>
                <%= new_form.text_area:content, rows: "5" %>
              </div>
            </div>              
              <%= new_form.hidden_field :_destroy %>

            </div>
          <% end %>
        </template>

          <%# current form %>
        <%= f.fields_for :ticket_types do |form|%>  
          <div class="ticketType-form" new-ticket_types ="<%= form.object.new_record? %>" >
            <div class="nested-basic-info">
              <%= form.text_field:title%>
              <%= form.number_field:quantity, placeholder: '數量', min: 0 %>
              <%= form.number_field:price, placeholder: '票價', min:0 %>


              <%= link_to '#', class:"card-link", data:{toggle:"collapse"}, role:"button", aria:{expanded:"false"}, data:{target:"#e"}, aria:{controls:"collapseExample"} do %>
                <i class="fas fa-chevron-circle-down"></i>
              <% end %>

              <%= link_to '#', data: { action: 'ticket-types-form#removeTicketType' } do %>
                <i class="far fa-trash-alt new-ticket-delete-btn"></i>
              <% end %>
            </div>


            <div class="collapse.show nested-hidden-info" id="e" >
              <div class="card card-body">
                <div>
                  <%= form.label:sell_start, '售票開始日'%>
                </div>

                <div>
                  <%= form.date_field:sell_start %>
                  <%= form.time_field:sell_start %>
                </div>

                <div>
                  <%= form.label:finish_datetime, '結束時間' %>
                </div>

                <div>
                  <%= form.date_field:sell_deadline %>
                  <%= form.time_field:sell_deadline %>
                </div>

                <%= form.label:content, '票券說明'%>
                <%= form.text_area:content, rows: "5" %>
              </div>
            </div>

            <%= form.hidden_field :_destroy %>

          </div>
        <% end %>



        <div data-action = "click->ticket-types-form#addTicketType" data-ticket-types-form-target="addBtn" class="nested-add-btn">
          <%= link_to '#' do %>
            <i class="fas fa-plus-circle"></i>付費票
          <% end %>
        </div>

        <div >
          <%= link_to '#' do %>
          <i class="fas fa-plus-circle"></i>免費票          
          <% end %>
        </div>
      </div>
    </div>


    <%# ticket_types form end %>
  <%= render 'ticket_types_form' %>

  <%= f.submit '送出' %>
  <% end %>


<script>
  $('.collapse').collapse('toggle')
</script>